def dice_metric(input, target):
    smooth = 1.

    intersection = (input * target).sum(dim=(1, 2, 3))
    cardinality = (input + target).sum(dim=(1, 2, 3))

    return (2. * intersection + smooth) / (cardinality + smooth)

